
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>m&amp;mf NameDB &#8212; m&amp;mf docs</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="m&amp;mf People Tracker" href="peopletracker.html" />
    <link rel="prev" title="m&amp;mf Influencer" href="influencer.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="peopletracker.html" title="m&amp;mf People Tracker"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="influencer.html" title="m&amp;mf Influencer"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">m&amp;mf docs</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="m-mf-namedb">
<h1>m&amp;mf NameDB<a class="headerlink" href="#m-mf-namedb" title="Permalink to this headline">¶</a></h1>
<p>NameDB is a script whose job is to “know” people - who is a person, and what they are. With this in your toolbox, you, and your aliases/triggers/scripts, can tell people apart.</p>
<p>NameDB is a dataminer script that collects information either automatically or by you providing it, and then provides you the same information for use.</p>
<p>For you yourself, the script provides a sophisticated <strong>highlighting feature</strong> - that can highlight, bold, italicize or underline names. It can highlight a person by their citizenship, your org/guild/order enemy status, or a special watchfor list you can manipulate. The highlighter “stacks” properly - if a person belongs to a group that should be underlined as well as to a group that should be in red, their name will be both underlined and in red. You can also <strong>ignore names</strong> you don’t want highlighted. All of this is configurable from your scripts or by hand, via an intuitive menu (<strong>mmconfig politics</strong>):</p>
<img alt="_images/namedb-politics.png" class="align-center" src="_images/namedb-politics.png" />
<p>For your <strong>triggers/aliases/scripts</strong>, there is a <em>multitude</em> of uses where this comes in handy. The most basic one is giving <strong>intelligence to your triggers</strong> - for example, if you want to make a trigger that will automatically geyser enemies flying above you, with NameDB your script will know if it’s an enemy or not before geysering - saving annoyances of your allies! If you only want to announce enemies or particular citizens for demesne watch, you can. All that without manually managing lists of people - saves you a lot of hassle. You could even analyze and know exactly, at a glance, what classes a raiding group consists of with its help! These are just a few examples. NameDB can help you with a ton of things, including extracting names from lines and so on.</p>
<p>NameDB allows you to store your own notes on a person, as well as remembering their title, class, org, org rank, guild, might, a custom importance level, their xp rank, and whenever they’re guild/order or org enemies. You can also explicitly set them to be enemies or allies to you, or have that be auto-determined altogether (based on their citizenship or being enemied to your org/guild/order).</p>
<div class="section" id="working-with-it">
<h2>Working with it<a class="headerlink" href="#working-with-it" title="Permalink to this headline">¶</a></h2>
<p>NameDB by default datamines everyone it comes across from cw, hw, citizens, guild/order/org enemies and qw lists (you can turn this off with <strong>mmconfig autohonors off</strong>) and other lists that involve names. It’ll automatically gag the honors of a person while doing that, so you don’t get spammed out - and it leaves the titles or guides/immortals intact, so you can tell when is the first time it notices them (as a little feature). You can enable/disable auto-honors with <strong>mmconfig autohonors</strong>.</p>
<img alt="_images/namedb-checking.png" class="align-center" src="_images/namedb-checking.png" />
<p>Once NameDB knows somebody, it’ll be helping you from there on - either with highlights or by allowing you to script with it. There are tons of places where your triggers could use help differentiating allies/friendlies, for example automatically enemying enemies as you see them, enemy-only demesne announces, and so on.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">note:</th><td class="field-body">Because the city/commune frequently isn’t shown on HONORS, names that have just been checked might not be getting highlighted - they are still being researched (checked on the website) for their city/commune. So if NameDB says it’s done checking, and you check qw again, and some names don’t have the highlights yet - it’s fine, in a few moments they will have them.</td>
</tr>
</tbody>
</table>
<p>If you’d like to add gemmed/offline people to it, honors them manually (with the <em>honors person</em> syntax). You can also script the addition of them (or build an importer) with the <em>ndb.addname(name)</em> function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">protip:</th><td class="field-body">You can create custom highlighting categories by adding people to fake Orders (their validity isn’t checked, and everything/all options get auto-created for any order name).</td>
</tr>
</tbody>
</table>
<p>NameDB doesn’t highlight your own name so it won’t blend in, plus some people wouldn’t want to have it highlight. It’s fairly easy to add a highlight trigger in Mudlet if you want to see it highlighted - put your name in as the substring in a new trigger, and tick the highlight checkbox.</p>
<p>Your home org for <em>mmconfig politics</em> is set via <em>mmconfig org &lt;org&gt;</em>.</p>
</div>
<div class="section" id="scripting-with-it">
<h2>Scripting with it<a class="headerlink" href="#scripting-with-it" title="Permalink to this headline">¶</a></h2>
<p>To begin scripting with NameDB, check the <a class="reference internal" href="#api"><span class="std std-ref">API</span></a>. There, all currently available functions are detailed to you, with practical examples that help you understand how to use them. If you need any help with them, feel free to ask on the m&amp;mf clan.</p>
<p>NameDB is designed to be built upon and extended - feel free to use its building blocks to build upon it or expand it.</p>
<p>::note:: Do not use any of NameDB’s internal functions (that is, those not listed on API) in your scripts - they are not documented for a reason - they may be changed, or deleted altogether, breaking your scripts. The ones on the API won’t be (same with m&amp;mf API functions) - use those instead!</p>
<p>To query the database for data, make use of <a class="reference external" href="http://wiki.mudlet.org/w/Manual:Database_Functions">Mudlet’s db</a> API.</p>
<p>Here are some practical examples:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- print a list of all Gloms CR4+&#39;s known</span>
<span class="n">vlua</span> <span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">person</span> <span class="kr">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">db</span><span class="p">:</span><span class="n">fetch</span><span class="p">(</span><span class="n">ndb</span><span class="p">.</span><span class="n">db</span><span class="p">.</span><span class="n">people</span><span class="p">,</span> <span class="p">{</span><span class="n">db</span><span class="p">:</span><span class="n">eq</span><span class="p">(</span><span class="n">ndb</span><span class="p">.</span><span class="n">db</span><span class="p">.</span><span class="n">people</span><span class="p">.</span><span class="n">org</span><span class="p">,</span> <span class="s2">&quot;Glomdoring&quot;</span><span class="p">),</span> <span class="n">db</span><span class="p">:</span><span class="n">gte</span><span class="p">(</span><span class="n">ndb</span><span class="p">.</span><span class="n">db</span><span class="p">.</span><span class="n">people</span><span class="p">.</span><span class="n">org_rank</span><span class="p">,</span> <span class="mi">4</span><span class="p">)}))</span> <span class="kr">do</span> <span class="nb">print</span><span class="p">(</span><span class="n">person</span><span class="p">.</span><span class="n">name</span><span class="p">)</span> <span class="kr">end</span>
</pre></div>
</div>
<div class="section" id="forcing-an-update-on-data">
<h3>Forcing an update on data<a class="headerlink" href="#forcing-an-update-on-data" title="Permalink to this headline">¶</a></h3>
<p>To update or add a person to NameDB, you can manually <em>honors</em> them. If you’d like to do it via scripting, the preferred way is to set the persons might xp rank to -1 (“unknown”) in the DB and raise a new data event. Here’s an example:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- force an update on a single name, Bouff</span>
<span class="kd">local</span> <span class="n">temp_name_list</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bouff&quot;</span><span class="p">,</span> <span class="n">xp_rank</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span> <span class="p">}</span>
<span class="n">db</span><span class="p">:</span><span class="n">merge_unique</span><span class="p">(</span><span class="n">ndb</span><span class="p">.</span><span class="n">db</span><span class="p">.</span><span class="n">people</span><span class="p">,</span> <span class="n">temp_name_list</span><span class="p">)</span>
<span class="n">raiseEvent</span><span class="p">(</span><span class="s2">&quot;NameDB got new data&quot;</span><span class="p">)</span>


<span class="c1">-- force an update on many names, from a list of names you&#39;ve got</span>
<span class="kd">local</span> <span class="n">names</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Bouff&quot;</span><span class="p">,</span> <span class="s2">&quot;Lianca&quot;</span><span class="p">,</span> <span class="s2">&quot;Teela&quot;</span><span class="p">,</span> <span class="s2">&quot;Malifuus&quot;</span><span class="p">}</span>
<span class="kd">local</span> <span class="n">temp_name_list</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">names</span> <span class="kr">do</span>
  <span class="n">temp_name_list</span><span class="p">[</span><span class="o">#</span><span class="n">temp_name_list</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xp_rank</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
<span class="kr">end</span>

<span class="n">db</span><span class="p">:</span><span class="n">merge_unique</span><span class="p">(</span><span class="n">ndb</span><span class="p">.</span><span class="n">db</span><span class="p">.</span><span class="n">people</span><span class="p">,</span> <span class="n">temp_name_list</span><span class="p">)</span>
<span class="n">raiseEvent</span><span class="p">(</span><span class="s2">&quot;NameDB got new data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="incompatibilities">
<h2>Incompatibilities<a class="headerlink" href="#incompatibilities" title="Permalink to this headline">¶</a></h2>
<p>If you are syncing your Mudlet profile using Dropbox, make sure <em>not</em> to sync the <strong>Database_namedb.db</strong> file - Dropbox seems to corrupt it and make it inoperable.</p>
<p>Be wary of storing it on a Linux NFS share as well - that seems to present issues as well.</p>
</div>
<div class="section" id="future-additions">
<h2>Future additions<a class="headerlink" href="#future-additions" title="Permalink to this headline">¶</a></h2>
<p>NameDB opens up for a <em>ton</em> of possibilities to be improved upon. Here are some ideas I’ve got that’ll be added in the future:</p>
<ul class="simple">
<li>storing a persons max health and mana</li>
<li>rogues as a category, so they can be highlighted</li>
<li>a way to remember when you’ve last seen a person, and</li>
<li>an option to highlight only recently seen people</li>
<li>making all of whois clickable</li>
<li>add a highlighting category for guild members</li>
<li>org allies tracking</li>
<li>add background highlighting for names</li>
</ul>
<p>If you’ve got more ideas, let me know. If you’d like to make any ideas happen yourself, you’re free to do so - the code is there.</p>
</div>
<div class="section" id="contributing-to-namedb">
<h2>Contributing to NameDB<a class="headerlink" href="#contributing-to-namedb" title="Permalink to this headline">¶</a></h2>
<p>All the code for NameDB is available for you to modify and improve upon. You do, however, assume the risk of breaking it on yourself by doing so!</p>
<p>Please contribute the changes you do to NameDB back, so they can be integrated with future releases and the wider community.</p>
</div>
<div class="section" id="aliases">
<h2>Aliases<a class="headerlink" href="#aliases" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-whois-person">whois &lt;person&gt;</dt>
<dd><p class="first">Gives you a a complete dossier on a person that NameDB knows of:</p>
<img alt="_images/namedb-whois.png" class="last align-center" src="_images/namedb-whois.png" />
</dd>
<dt id="term-mmconfig-politics">mmconfig politics</dt>
<dd>Gives you a menu where you can adjust org relationship stances, and setup highlights.</dd>
<dt id="term-mmconfig-autohonors-yep-nope">mmconfig autohonors yep/nope</dt>
<dd>Sets whenever NameDB should automatically honors new people it comes across to gather information about them or not.</dd>
<dt id="term-ndb">ndb</dt>
<dd>NameDB alias cheetsheet - shows the same information as this aliases list. Hover your mouse or click on an alias to see the description.</dd>
<dt id="term-ndb-long">ndb long</dt>
<dd>NameDB alias cheetsheet, with the descriptions expanded.</dd>
<dt id="term-qw">qw</dt>
<dd>Checks the QW list, from which ndb will be able to pick up new names from.</dd>
<dt id="term-qw-update">qw update</dt>
<dd>Re-checks all names on the QW list, even if they’re already and currently known.</dd>
<dt id="term-qwc">qwc</dt>
<dd><p class="first">Checks the QW list, from which ndb will be able to pick up new names from. It’ll also display you a menu of players present by their organization affiliation, sorted:</p>
<img alt="_images/namedb-qwc.png" class="last align-center" src="_images/namedb-qwc.png" />
</dd>
<dt id="term-ppof-org">ppof &lt;org&gt;</dt>
<dd>Reports the members of an org to an m&amp;mf cc channel. You can shorten the name of an org, ie <em>ppof glom</em> will work.</dd>
<dt id="term-guild-order-city-commune-enemies">guild/order/city/commune enemies</dt>
<dd>Sets the enemy status of the people that NameDB knows of from those lists. This won’t auto-add names it doesn’t know for checking (so your db doesn’t get filled up with dormant people and they’ll be getting highlighted for no reason).</dd>
<dt id="term-guild-order-city-commune-enemies-add">guild/order/city/commune enemies add</dt>
<dd>Sets the enemy status of the people from those lists, and auto-adds names it doesn’t know for checking.</dd>
<dt id="term-cwho">cwho</dt>
<dd><p class="first">Adds the persons class information into cwho list. An (h) will be visible if the person is a Demigod or an Ascendant - H stands for them being able to access Havens. The cwho list looks best with <code class="docutils literal notranslate"><span class="pre">CONFIG</span> <span class="pre">PREFERREDWIDTH</span> <span class="pre">100</span></code> in order to have the class name fit in.</p>
<img alt="_images/namedb-cwho.png" class="last align-center" src="_images/namedb-cwho.png" />
</dd>
<dt id="term-ndb-honorsnew">ndb honorsnew</dt>
<dd>If mmconfig autohonors is off, ndb honorsnew will allow NameDB to honors the new people it knows of.</dd>
<dt id="term-ndb-cancel">ndb cancel</dt>
<dd>Stops honors’ing the list of people that need to be checked.</dd>
<dt id="term-npp">npp</dt>
<dd>Stops/resumes name highlighting. You might want to turn highlighting off for wargames, for example, where the game-provided colors are more important.</dd>
<dt id="term-npp-on-off">npp on/off</dt>
<dd>Stops/resumes name highlighting explicitly.</dd>
<dt id="term-mmconfig-highlightignore-person">mmconfig highlightignore &lt;person&gt;</dt>
<dd>Adds/removes a name on the list that keeps track of who should not be highlighted.</dd>
<dt id="term-mmshow-highlightignore">mmshow highlightignore</dt>
<dd>Shows the list of persons who shouldn’t be highlighted.</dd>
<dt id="term-iff-person-ally-enemy-auto">iff &lt;person&gt; ally/enemy/auto</dt>
<dd><p class="first">Explicitly sets a persons status to you, overriding the auto-determination of enemy vs non-enemy by NameDB.</p>
<p>Making them an ally will make NameDB disregard their citizenship and political stances and whenever they’re a guild/order/city/commune enemy - thus never considering them an enemy.</p>
<p>Making them an enemy will always consider them an enemy, disregarding anything else.</p>
<p class="last">Setting it to auto will have NameDB compute their status to you depending on a number of things - if they’re in a org that is considered an enemy to you, or if they’re a guild/org/order enemy, they’ll be considered an enemy. Otherwise, they won’t be an enemy. Note that if someone is in an org that is allied with yours and they are an enemy of your org, they will not be considered an enemy.</p>
</dd>
<dt id="term-ndb-set-person-notes-notes">ndb set &lt;person&gt; notes &lt;notes&gt;</dt>
<dd>Adjusts the notes you have on the person to the new ones. If you do <em>whois person</em> and click on <em>‘edit’</em>, you an edit current notes you have on them. You can use the same color formatting from a cecho to color your notes (ie <em>&lt;red&gt; text</em>), and insert n’s in the same manner to get a linebreak.</dd>
<dt id="term-ndb-export">ndb export</dt>
<dd>Opens up a menu where you can export your data. It allows you to selectively export fields (so you don’t have to share everything, for example, not your notes), and which people to export (atm, it’s everybody).</dd>
<dt id="term-ndb-import">ndb import</dt>
<dd>Opens up a menu where you can import exported NameDB data. You can selectively choose which fields about a person should be imported - they will overwrite what you’ve had. This will not clear your names in NameDB that you’ve got already - if you’d like to start clean, use ‘ndb delete all’.</dd>
<dt id="term-ndb-delete-person">ndb delete &lt;person&gt;</dt>
<dd>Wipes an individual entry from NameDB.</dd>
<dt id="term-ndb-delete-all">ndb delete all</dt>
<dd>Wipes all data from the database, essentially making you start over clean. You have to use this alias twice for it to go off. If you have a lot of names (10k+), expect to wait a few seconds for it to finish.</dd>
<dt id="term-ndb-update-all">ndb update all</dt>
<dd>Re-checks every person in the database. This can’t be undone, only paused (with <em>ndb cancel</em>) - NameDB will re-check everybody as you’ve asked it to, so don’t do it on a whim!</dd>
<dt id="term-ndb-set-person-class-class">ndb set &lt;person&gt; class &lt;class&gt;</dt>
<dd>Manually sets/adjusts the persons class. It’s always stored in lowercase by NameDB. NameDB automatically picks up the class from cwho and gwho lists, but this isn’t possible for everyone.</dd>
<dt id="term-ndb-set-person-city-commune-org-city-commune">ndb set &lt;person&gt; city/commune/org &lt;city/commune&gt;</dt>
<dd>Manually changes the persons city/commune. It’s always stored in proper case (first letters capitalized) by NameDB. NameDB automatically picks it up from honors for you already.</dd>
<dt id="term-ndb-set-person-title-title">ndb set &lt;person&gt; title &lt;title&gt;</dt>
<dd>Adjusts the persons title as NameDB knows it. It’s not really useful for much, as titles change all the time, but the option to set/retrieve them is there for you.</dd>
<dt id="term-ndb-set-person-org-rank-rank">ndb set &lt;person&gt; org_rank &lt;rank&gt;</dt>
<dd>Manually adjusts the persons org rank. 0 is known, 1 is cr1 and 6 is cr6. NameDB automatically picks up the org rank from honors for you when it is shown.</dd>
<dt id="term-ndb-set-person-guild-guild">ndb set &lt;person&gt; guild &lt;guild&gt;</dt>
<dd>Manually adjusts the persons guild affiliation. NameDB can only capture this from gwho or guild members, so you’d want to use this for setting others’ guilds if that’s something you want to track.</dd>
<dt id="term-ndb-set-person-order-order">ndb set &lt;person&gt; order &lt;order&gt;</dt>
<dd>Manually adjusts the persons Order affiliation. NameDB stores it with proper titlecase, and it’ll pull information from ORDER MEMBERS for you. You will need to manually input the members of other Orders though.</dd>
<dt id="term-ndb-set-person-might-might">ndb set &lt;person&gt; might &lt;might&gt;</dt>
<dd>Adjusts the persons might (lessons invested vs you) relative to you - 0 is 0% of your might, 100 is equal to you. <em>-1</em> is unknown, and will cause NameDB to re-honors the person. NameDB automatically captures this from honors.</dd>
<dt id="term-ndb-set-person-importance-number">ndb set &lt;person&gt; importance &lt;number&gt;</dt>
<dd>Manually sets a persons “importance”. This isn’t used by NameDB, but it’s a way for you to explicitly prioritize people without relying on heuristics such as org rank and might.</dd>
<dt id="term-ndb-set-person-xp-rank-number">ndb set &lt;person&gt; xp_rank &lt;number&gt;</dt>
<dd>Manually sets the persons rank in experience in the game. <em>-2</em> is unranked, <em>-1</em> is unknown - this’ll cause NameDB to auto-honors the person. Any other number is their actual rank. NameDB automatically captures this from honors.</dd>
<dt id="term-ndb-set-person-immortal-yep-nope">ndb set &lt;person&gt; immortal &lt;yep/nope&gt;</dt>
<dd>Manually adjusts whenever somebody is an Immortal or not. This means Gods, Ephemereals and admins. NameDB automatically captures this from honors.</dd>
<dt id="term-ndb-set-person-orgenemy-guildenemy-orderenemy-yep-nope">ndb set &lt;person&gt; orgenemy/guildenemy/orderenemy &lt;yep/nope&gt;</dt>
<dd>Manually sets whenever the person is your orgs, guilds or orders enemy.  NameDB automatically captures this from the enemy lists, but you can adjust it manually as well.</dd>
<dt id="term-ndb-stats">ndb stats</dt>
<dd>A little stats alias showing the number of people known and city populations.</dd>
<dt id="term-mmconfig-watchfor-name">mmconfig watchfor &lt;name&gt;</dt>
<dd>Adds or removes a person on the watchfor list - used in as a custom highlighting category in NameDB. You can script this as well - put the name down as a key in the <code class="docutils literal notranslate"><span class="pre">mm.me.watchfor</span></code> table. To remove a name, set it to nil (not false).</dd>
</dl>
</div>
<div class="section" id="api">
<span id="id1"></span><h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-ndb-isenemy-name">ndb.isenemy(name)</dt>
<dd><p class="first">Returns true if the person is your enemy - whenever they are explicitly marked as one via <em>iff &lt;name&gt; enemy&gt;</em> or they are in a org that you are at war with per <em>mmconfig politics</em>, or they are a org, guild or order enemy.</p>
<p>This function is useful to use in auto-action triggers, for example only geyser your enemies and not everybody:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">isenemy</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="kr">then</span>
  <span class="n">mm</span><span class="p">.</span><span class="n">doadd</span><span class="p">(</span><span class="s2">&quot;cast geyser at &quot;</span> <span class="o">..</span> <span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="kr">end</span>
</pre></div>
</div>
<p>Or automatically pick up monolith sigils and enemy drops:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- pattern (perl regex): ^(\w+) drops a monolith sigil\.$</span>

<span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">isenemny</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="kr">then</span>
  <span class="n">mm</span><span class="p">.</span><span class="n">doaddfree</span><span class="p">(</span><span class="s2">&quot;get monolith&quot;</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div>
</div>
<p>Or only announce enemies on mindnet:</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">isenemy</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="kr">then</span>
  <span class="n">mm</span><span class="p">.</span><span class="n">cc</span><span class="p">(</span><span class="s2">&quot;%s has entered %s!&quot;</span><span class="p">,</span> <span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">gmcp</span><span class="p">.</span><span class="n">Room</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">area</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-isperson-name">ndb.isperson(name)</dt>
<dd><p class="first">Returns true if the given name is one NameDB knows of.</p>
<p>This function is useful for making your attacks differentiate between PvP and bashing, as one example:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">isperson</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="kr">then</span>
  <span class="n">send</span><span class="p">(</span><span class="s2">&quot;kick &quot;</span><span class="o">..</span><span class="n">target</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="kr">else</span>
  <span class="n">send</span><span class="p">(</span><span class="s2">&quot;kill &quot;</span><span class="o">..</span><span class="n">target</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div>
</div>
<p>In another example, you could automatically enemy in your target alias:</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">isperson</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mm</span><span class="p">.</span><span class="n">inslowcuringmode</span><span class="p">()</span> <span class="kr">then</span>
  <span class="n">send</span><span class="p">(</span><span class="s2">&quot;enemy &quot;</span><span class="o">..</span><span class="n">target</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-exists-name">ndb.exists(name)</dt>
<dd>Returns true if the given character name exists as NameDB knows it.</dd>
<dt id="term-ndb-getname-name">ndb.getname(name)</dt>
<dd><p class="first">Returns a table with all information known about a name - useful to use if you want to check multiple fields of a person.</p>
<p>Here’s an example that shows the persons class, guild and org at once:</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kd">local</span> <span class="n">person</span> <span class="o">=</span> <span class="n">ndb</span><span class="p">.</span><span class="n">getname</span><span class="p">(</span><span class="s2">&quot;Vadi&quot;</span><span class="p">)</span>

<span class="c1">-- if ndb doesn&#39;t know the person, it&#39;ll return nil, so handle that</span>
<span class="kr">if</span> <span class="ow">not</span> <span class="n">person</span> <span class="kr">then</span> <span class="n">mm</span><span class="p">.</span><span class="n">echof</span><span class="p">(</span><span class="s2">&quot;I&#39;m afraid I don&#39;t know Vadi yet.&quot;</span><span class="p">)</span> <span class="kr">return</span> <span class="kr">end</span>

<span class="n">mm</span><span class="p">.</span><span class="n">echof</span><span class="p">(</span><span class="s2">&quot;Vadi&#39;s class that we know of is %s, and he&#39;s a %s in %s.&quot;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">class</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">guild</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">org</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-findname-line">ndb.findname(line)</dt>
<dd>Given a line, returns the first character name it finds on it.</dd>
<dt id="term-ndb-findnames-line">ndb.findnames(line)</dt>
<dd>Given a line, returns a list of known character names found on it. If no names are found, it returns nil.</dd>
<dt id="term-ndb-isclass-name-class">ndb.isclass(name, class)</dt>
<dd><p class="first">Returns true if the given person is known to be of that class.</p>
<p>An example of use:</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- on a trigger where the person lands in your room</span>
<span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;blacktalon&quot;</span><span class="p">)</span> <span class="kr">then</span>
  <span class="n">mm</span><span class="p">.</span><span class="n">echof</span><span class="p">(</span><span class="s2">&quot;This person is a melder!&quot;</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-getclass-name">ndb.getclass(name)</dt>
<dd>Returns the known class of a person. If the person isn’t known, it returns nil - and if the class isn’t known, it returns “”.</dd>
<dt id="term-ndb-setclass-name-class">ndb.setclass(name, class)</dt>
<dd>Sets the class on a given person.</dd>
<dt id="term-ndb-getorg-name">ndb.getorg(name)</dt>
<dd><p class="first">Returns the known org of a person. If the person isn’t known, it returns nil - and if the org isn’t known, it returns “”.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- check if somebody is from a particular org. The org name should be capitalized.</span>
<span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">getorg</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;Hallifax&quot;</span> <span class="kr">then</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-isglom-name">ndb.isglom(name)<dt id="term-ndb-ismag-name">ndb.ismag(name)<dt id="term-ndb-iscelest-name">ndb.iscelest(name)<dt id="term-ndb-ishalli-name">ndb.ishalli(name)<dt id="term-ndb-isgaudi-name">ndb.isgaudi(name)<dt id="term-ndb-isseren-name">ndb.isseren(name)</dt>
<dd><p class="first">Convenience functions, return true if the person belongs to the given org. You might want to use ndb.isenemy() when checking for enemies instead, as then you can configure which citizens you consider your enemies to be via a menu, instead of having to change all your code.</p>
<p>Here are some examples:</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">isglom</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="kr">then</span>

<span class="kr">if</span> <span class="ow">not</span> <span class="n">ndb</span><span class="p">.</span><span class="n">ishalli</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span> <span class="kr">then</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-getnotes-name">ndb.getnotes(name)</dt>
<dd>Returns the notes that you’ve stored about a person - or “” if you haven’t got any.</dd>
<dt id="term-ndb-isdemigod-name">ndb.isdemigod(name)</dt>
<dd><p class="first">Returns true or false depending on whenever the person is a known Demigod or Ascendant. If the person isn’t known, it returns nil.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- see if a given person is a Demigod</span>
<span class="kr">if</span> <span class="n">ndb</span><span class="p">.</span><span class="n">isdemogid</span><span class="p">(</span><span class="s2">&quot;Vadi&quot;</span><span class="p">)</span> <span class="kr">then</span>
  <span class="n">mm</span><span class="p">.</span><span class="n">echof</span><span class="p">(</span><span class="s2">&quot;Vadi is a demi/ascendant!&quot;</span><span class="p">)</span>
<span class="kr">end</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-setdemigod-name-status">ndb.setdemigod(name, status)</dt>
<dd><p class="first">Sets whenever a person is a Demigod or not. The status can be a <code class="docutils literal notranslate"><span class="pre">true</span></code>/<code class="docutils literal notranslate"><span class="pre">false</span></code> boolean or a string affirmation (yep/nope and so on) value.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="n">ndb</span><span class="p">.</span><span class="n">setdemigod</span><span class="p">(</span><span class="s2">&quot;Vadi&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="n">ndb</span><span class="p">.</span><span class="n">setdemigod</span><span class="p">(</span><span class="s2">&quot;Vadi&quot;</span><span class="p">,</span> <span class="s2">&quot;yep&quot;</span><span class="p">)</span>

<span class="n">ndb</span><span class="p">.</span><span class="n">setdemigod</span><span class="p">(</span><span class="s2">&quot;Unnamednewbie&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="n">ndb</span><span class="p">.</span><span class="n">setdemigod</span><span class="p">(</span><span class="s2">&quot;Unnamednewbie&quot;</span><span class="p">,</span> <span class="s2">&quot;nope&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-setiff-name-status">ndb.setiff(name, status)</dt>
<dd><p class="first">Adjusts <code class="docutils literal notranslate"><span class="pre">iff</span></code> (see the <code class="docutils literal notranslate"><span class="pre">iff</span></code> alias) of a person. Status can be <code class="docutils literal notranslate"><span class="pre">auto</span></code>, <code class="docutils literal notranslate"><span class="pre">ally</span></code> or <code class="docutils literal notranslate"><span class="pre">enemy</span></code>.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- we don&#39;t like Bob anymore. Set him to be treated as an enemy now by ndb.isenemy()</span>
<span class="n">ndb</span><span class="p">.</span><span class="n">setiff</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;enemy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-isimmortal-name">ndb.isimmortal(name)</dt>
<dd>Returns true or false depending on whenever the person is a known Immortal (that is - Guide, God or Ephemeral).</dd>
<dt id="term-ndb-getpluralorg-org-count">ndb.getpluralorg(org, count)</dt>
<dd><p class="first">Given a org affiliation and a number of citizens from it, returns either the singlar or plural variation of the org name.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- the following will say: There are 5 Gloms</span>
<span class="kd">local</span> <span class="n">org</span><span class="p">,</span> <span class="n">amount</span> <span class="o">=</span> <span class="s2">&quot;Glomdoring&quot;</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">mm</span><span class="p">.</span><span class="n">cc</span><span class="p">(</span><span class="s2">&quot;There are %s %s&quot;</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">ndb</span><span class="p">.</span><span class="n">getpluralorg</span><span class="p">(</span><span class="n">org</span><span class="p">,</span> <span class="n">amount</span><span class="p">))</span>

<span class="c1">-- the following will say: 1 Seren</span>
<span class="kd">local</span> <span class="n">org</span><span class="p">,</span> <span class="n">amount</span> <span class="o">=</span> <span class="s2">&quot;Serenwilde&quot;</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">mm</span><span class="p">.</span><span class="n">cc</span><span class="p">(</span><span class="s2">&quot;%s %s&quot;</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">ndb</span><span class="p">.</span><span class="n">getpluralorg</span><span class="p">(</span><span class="n">org</span><span class="p">,</span> <span class="n">amount</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-getcolor-name">ndb.getcolor(name)</dt>
<dd><p class="first">Returns you the cecho color for the given persons name, or ‘’ if there is none (they aren’t highlighted). You can use this to make echoes where peoples names are colored as they would be by NameDB.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- you can insert the color as a variable, between ..&#39;s:</span>
<span class="n">cecho</span><span class="p">(</span><span class="s2">&quot;Highlights: &quot;</span><span class="o">..</span><span class="n">ndb</span><span class="p">.</span><span class="n">getcolor</span><span class="p">(</span><span class="s2">&quot;Iosai&quot;</span><span class="p">)</span><span class="o">..</span><span class="s2">&quot;Iosai&lt;a_grey&gt;, &quot;</span><span class="o">..</span><span class="n">ndb</span><span class="p">.</span><span class="n">getcolor</span><span class="p">(</span><span class="s2">&quot;Vadi&quot;</span><span class="p">)</span><span class="o">..</span><span class="s2">&quot;Vadi&quot;</span><span class="p">)</span>

<span class="c1">-- or be a bit more fancy about it, using string.format to insert the color:</span>
<span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">({</span><span class="s2">&quot;Iosai&quot;</span><span class="p">,</span> <span class="s2">&quot;Vadi&quot;</span><span class="p">,</span> <span class="s2">&quot;Viynain&quot;</span><span class="p">,</span> <span class="s2">&quot;Shuyin&quot;</span><span class="p">,</span> <span class="s2">&quot;Svorai&quot;</span><span class="p">})</span> <span class="kr">do</span>
  <span class="n">cecho</span><span class="p">(</span><span class="nb">string.format</span><span class="p">(</span><span class="s2">&quot;Name in color: %s%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ndb</span><span class="p">.</span><span class="n">getcolor</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">name</span><span class="p">))</span>
<span class="kr">end</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-getcolorp-name">ndb.getcolorp(name)</dt>
<dd>Returns you the foreground color that the person would be highlighted as, if they are meant to be. If they aren’t meant to be highlighted or the person isn’t known, returns nil.</dd>
<dt id="term-ndb-shouldbold-name">ndb.shouldbold(name)</dt>
<dd><p class="first">Returns true if the persons name would be bolded by NameDB, or false otherwise. This would be helpful to use in conjunction with <a class="reference external" href="http://wiki.mudlet.org/w/Manual:UI_Functions#setBold">setBold()</a>.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- enables or disables bolding, depending whenever Aradors name is bolded by NameDB</span>
<span class="n">setBold</span><span class="p">(</span><span class="n">ndb</span><span class="p">.</span><span class="n">shouldbold</span><span class="p">(</span><span class="s2">&quot;Arador&quot;</span><span class="p">))</span>
<span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Arador&quot;</span><span class="p">)</span>
<span class="n">resetFormat</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-shoulditalicize-name">ndb.shoulditalicize(name)</dt>
<dd><p class="first">Returns true if the persons name would be italicized by NameDB, or false otherwise. This would be helpful to use in conjunction with <a class="reference external" href="http://wiki.mudlet.org/w/Manual:UI_Functions#setItalics">setItalics()</a>.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- enables or disables undernlined text, depending whenever Aradors name is italicized by NameDB</span>
<span class="n">setItalics</span><span class="p">(</span><span class="n">ndb</span><span class="p">.</span><span class="n">shoulditalicize</span><span class="p">(</span><span class="s2">&quot;Arador&quot;</span><span class="p">))</span>
<span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Arador&quot;</span><span class="p">)</span>
<span class="n">resetFormat</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-shouldunderline-name">ndb.shouldunderline(name)</dt>
<dd><p class="first">Returns true if the persons name would be underlined by NameDB, or false otherwise. This would be helpful to use in conjunction with <a class="reference external" href="http://wiki.mudlet.org/w/Manual:UI_Functions#setUnderline">setUnderline()</a>.</p>
<div class="last highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- enables or disables undernlined text, depending whenever Aradors name is underlined by NameDB</span>
<span class="n">setUnderline</span><span class="p">(</span><span class="n">ndb</span><span class="p">.</span><span class="n">shouldunderline</span><span class="p">(</span><span class="s2">&quot;Arador&quot;</span><span class="p">))</span>
<span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Arador&quot;</span><span class="p">)</span>
<span class="n">resetFormat</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt id="term-ndb-isorgenemy-name">ndb.isorgenemy(name)</dt>
<dd>Similar to ndb.isenemy - but ignores whenever someone is a guild enemy or not. So it checks everything else that ndb.isenemy checks (citizenship, iff, and org) while ignoring the status of someone being your guild’s enemy.</dd>
<dt id="term-namedb-highlights-reloaded-event">“NameDB highlights reloaded” (event)</dt>
<dd>This Mudlet event is raised when NameDB reloads all name highlights - so that you can make temp triggers after this event that take advantage of already-highlighted text.</dd>
<dt id="term-mm-config-set-ndbpaused-option-true">mm.config.set(“ndbpaused”, option, true)</dt>
<dd>Disables or enables NameDB highlighting (same as what the <code class="docutils literal notranslate"><span class="pre">npp</span></code> alias does). <code class="docutils literal notranslate"><span class="pre">option</span></code> is a toggle in the same manner as <code class="docutils literal notranslate"><span class="pre">svo.config.set()</span></code> operates - it can be <code class="docutils literal notranslate"><span class="pre">true</span></code>, <code class="docutils literal notranslate"><span class="pre">false</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;on&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;off&quot;</span></code> and so on. The last argument, <code class="docutils literal notranslate"><span class="pre">true</span></code>, has to be there for the function to take effect.</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">m&amp;mf NameDB</a><ul>
<li><a class="reference internal" href="#working-with-it">Working with it</a></li>
<li><a class="reference internal" href="#scripting-with-it">Scripting with it</a><ul>
<li><a class="reference internal" href="#forcing-an-update-on-data">Forcing an update on data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#incompatibilities">Incompatibilities</a></li>
<li><a class="reference internal" href="#future-additions">Future additions</a></li>
<li><a class="reference internal" href="#contributing-to-namedb">Contributing to NameDB</a></li>
<li><a class="reference internal" href="#aliases">Aliases</a></li>
<li><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="influencer.html"
                        title="previous chapter">m&amp;mf Influencer</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="peopletracker.html"
                        title="next chapter">m&amp;mf People Tracker</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/namedb.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="peopletracker.html" title="m&amp;mf People Tracker"
             >next</a> |</li>
        <li class="right" >
          <a href="influencer.html" title="m&amp;mf Influencer"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">m&amp;mf docs</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Vadim Peretokin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>